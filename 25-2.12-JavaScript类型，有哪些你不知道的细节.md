# JavaScript类型：关于类型，有哪些你不知道的细节

任何语言，其基本类型都是每个程序员必须掌握的概念，但是，这些概念你是真正的全部了解吗？其中包含哪些细节内容？看看下面的几个问题。

- 为什么有的编程规范要求用 void 0 代替 undefined？
- 字符串有最大长度吗？
- 0.1 + 0.2 不是等于 0.3 么？为什么 JavaScript 里得到的答案不是这样的？
- ES6 新加入的 Symbol 对象是什么？
- 为什么给对象添加的方法能用在基本类型上？

前面的学习过程中，对 JavaScript 模块从运行时、文法和执行过程三个角度去进行剖析了其知识体系，这里的学习内容就是从运行时的角度去看 JavaScript 的类型系统的。  
> 运行时类型是代码实际执行过程中我们用到的类型，所有的类型数据都会属于7个类型之一。从变量、参数、返回值到表达式中间结果，任何 JavaScript 代码运行过程中产生的数据，都具有运行时类型。

## 类型

JavaScript 语言的每一个值都属于某一种数据类型，JavaScript 语言规定了 7 种语言类型。  
语言类型广泛用于变量、函数参数、表达式、函数返回值等场合，根据最新的语言标准，这7种语言类型是：

1. Undefined
2. Null
3. Boolean
4. String
5. Number
6. Symbol
7. Object

除了ES6中新加入的 Symbol 类型，其余 6 种类型都是我们日常开发常用的，但是，文章开头的几个问题要得到解决就需要对这几个老知识进行重新认识。

## Undefined、Null

前面的第一个问题，为什么有的编程规范要求用 void 0 代替 undefined？  
  
Undefined 类型表示未定义，它的类型只有一个值，就是 undefined。任何变量在赋值前都是 Undefined 类型，其值为 undefined，一般我们可以用全局变量 undefined (就是名为 undefined 的这个变量) 来表达这个值，或者 void 运算来把任意一个表达式变成 undefined 值。  
  
但是，因为 JavaScript 的代码 undefined 是一个变量，而并非是一个关键字(这是 JavaScript 语言公认的设计失误之一)，所以，我们为了避免无意中被篡改，在代码中通常建议使用 void 0 来获取 undefined 值。(在现代浏览器中我们直接将 undefined 变量进行赋值再进行改变是咩有任何作用的，原因是问什么呢？在 MDN 中<https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/undefined>有详细的描述，其描述为自 ECMAscript5标准以来undefined是一个不能被配置[non-configurable]，不能被重写[non-writable]的属性，因此在现在浏览器中我们改变它的值是没有任何作用，即便这样，也要避免重写它)  
  
Undefined 跟 null 有一定的表意差别，null 表示的是：“定义了但是为空”。所以，在实际编码过程中，一般不会把变量赋值为 undefined，这样可以保证所有值为 undefined 的变量都是从未赋值过的自然状态。  
  
Null 类型也只有一个值，就是 null，它的语义表示空值，与 undefined 不同，null 是 JavaScript 关键字，所以在任何代码中都可以放心使用 null 关键字来获取 null 值。

## Boolean

Boolean 类型有两个值，true 和 false，它用于表示逻辑意义上的真和假，同样有关键字 true 和 false 来表示两个值。

## String

这里先看第二个问题，字符串是否有最大长度？  
  
String 用于表示文本数据，String 有最大长度是 Math.pow(2,53) - 1，这在一般开发中都够用，但是有趣的是，这个所谓的最大长度并不完全是我们理解中的字符数。  
  
因为 String 的意义并非“字符串”，而是字符串的 UTF16 编码，我们字符串的操作 charAt、charCodeAt、length 等方法针对的都是 UTF16 编码。所以，字符串的最大长度实际上是受字符串的编码长度影响的。
> Note: 现行的字符集国际标准，字符是以 Unicode 的方式表示的，每一个 Unicode 的码点表示一个字符，理论上，Unicode 的范围是无限的。 UTF 是 Unicode 的编码方式，规定了码点在计算机中的表示方法，常见的有 UTF16 和 UTF8。Unicode 的码点通常用 U+??? 来表示，其中 ??? 是十六进制的码点值。0-65536 (U+0000 - U+FFFF) 的码点被称为基本字符区域(BMP)。
  
JavaScript 中的字符串是永远无法变更的，一旦字符串构造出来，无法用任何方式改变字符串的内容，所以字符串具有值类型的特征。  
  
JavaScript 字符串把每个 UTF16 单元当做一个字符来处理，所以处理非 BMP(超出U+0000 - U+FFFF)范围的字符时，应当小心操作。  
  
JavaScript 这个设计继承自 Java，最新标准的解释是：为了“性能和尽可能实现起来简单”，因为现实中很少有能用到 BMP 之外的字符的场景。

## Number